# Dosely - Medicine Tracker Frontend

This is the frontend application for **Dosely**, a modern medicine inventory tracking system.

> ğŸ¤– **AI-Generated Codebase**
> This entire frontend architecture, design system, and logic was **generated by AI**, meticulously **prompted and engineered by Abu Jubair**.

## ğŸ— Architecture & Design

The application is built using **React (Vite)** with **TypeScript**, following a clean, component-based architecture.

### Directory Structure
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/       # Reusable UI Components
â”‚   â”‚   â”œâ”€â”€ modals/       # Smart Modals (CreateStock, EditStock, Delete*)
â”‚   â”‚   â”œâ”€â”€ Layout.tsx    # Main App Shell
â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.tsx # Auth Guard
â”‚   â”‚   â””â”€â”€ StockCardItem.tsx # Dashboard Stock Card
â”‚   â”‚
â”‚   â”œâ”€â”€ context/          # Global State
â”‚   â”‚   â””â”€â”€ AuthContext.tsx # JWT Handling & User Session
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/            # Route Views
â”‚   â”‚   â”œâ”€â”€ Login.tsx     # Auth Pages
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx # Main Inventory List (Infinite Scroll)
â”‚   â”‚   â””â”€â”€ StockDetail.tsx # Medicine Management Grid
â”‚   â”‚
â”‚   â”œâ”€â”€ services/         # API Layer (Axios)
â”‚   â”‚   â”œâ”€â”€ api.ts        # Interceptors (Auto-Logout on 401)
â”‚   â”‚   â”œâ”€â”€ authService.ts
â”‚   â”‚   â””â”€â”€ stockService.ts
```

## ğŸš€ Key Features

### 1. âš¡ï¸ Optimistic UI Updates
The application feels instant because it updates the UI *before* the server responds.
-   **Add Medicine**: Instantly appears in the list.
-   **Rename Stock**: Title updates immediately.
-   **Delete**: Item vanishes instantly (reverts if API fails).

### 2. ğŸ“± Responsive & Premium Design
-   **Mobile-First**: Complex grids (like the Morning/Noon/Evening schedule) stack beautifully on mobile.
-   **Visual Cues**:
    -   **Color Coding**: Red (Low), Orange (Med), Green (High) for stock levels.
    -   **Feedback**: Loading spinners inside buttons during async actions.

### 3. ğŸ” Secure Authentication
-   **JWT Handling**: Tokens are stored in `localStorage` and automatically injected into headers via Axios interceptors.
-   **Route Protection**: Unauthenticated users are strictly redirected to `/login` by the `ProtectedRoute` wrapper.

---

## ğŸ“¦ Setup & Installation

1.  **Install Dependencies**
    ```bash
    npm install
    ```

2.  **Environment Setup**
    Create `.env` (or rely on defaults):
    ```env
    VITE_API_URL=http://localhost:3000
    ```

3.  **Run Development Server**
    ```bash
    npm run dev
    ```

4.  **Build for Production**
    ```bash
    npm run build
    ```

---

## ğŸ§  Master Build Prompt

The contents below are the **Exact Instructions** given to the AI Agent to build this application. Use this reference to understand the intended behavior of every component.

```markdown
# Frontend Application Build Prompt

You are an expert Senior Frontend Engineer. Your task is to build a robust, production-ready frontend for a **Medicine Tracker Application** called "Dosely".

**Target Stack:**
-   **Framework:** React (Vite)
-   **Language:** TypeScript
-   **Styling:** Tailwind CSS (Vanilla, no external UI libraries like Shadcn/MUI unless specified for icons)
-   **Icons:** `lucide-react`
-   **Routing:** `react-router-dom`
-   **HTTP Client:** `axios`
-   **State Management:** React Context API + Local State
-   **Build Tool:** Vite

## 1. Project Structure & Setup

Initialize the project with the following structure:
frontend/
â”œâ”€â”€ src/ (or root if preferred, but keep consistent)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ modals/
â”‚   â”‚   â”‚   â”œâ”€â”€ CreateStockModal.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EditStockModal.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ DeleteStockModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ DeleteMedicineModal.tsx
â”‚   â”‚   â”œâ”€â”€ Layout.tsx
â”‚   â”‚   â”œâ”€â”€ Modal.tsx (Generic Reusable Modal)
â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.tsx
â”‚   â”‚   â””â”€â”€ StockCardItem.tsx
â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â””â”€â”€ AuthContext.tsx
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â”œâ”€â”€ Signup.tsx
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â””â”€â”€ StockDetail.tsx
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ authService.ts
â”‚   â”‚   â””â”€â”€ stockService.ts
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ main.tsx
â”‚   â””â”€â”€ types.ts

## 2. Core Logic & State Management

### A. Authentication (`AuthContext + ProtectedRoute`)
-   **Token Storage:** Store JWT in `localStorage` key `dosely_token`.
-   **Context:** `AuthContext` provides `token`, `login(token)`, `logout()`, `isAuthenticated`, `loading`.
-   **Auto-Login:** On mount, check `localStorage` for token. Set `loading` to false after check.
-   **Protection:** `ProtectedRoute` component checks `isAuthenticated`. If false, redirect to `/login`.
-   **Interceptor:** In `api.ts`, add an Axios interceptor to:
    1.  Inject `Authorization: Bearer <token>` on every request.
    2.  Catch `401 Unauthorized` responses -> `localStorage.removeItem` -> Redirect to login.

### B. Types (`types.ts`)
Define these exact interfaces:
-   **User**: `id`, `name`, `email`.
-   **Medicine**: `id`, `name`, `dose` (string|number), `quantity` (string|number), `takeMorning` (boolean), `takeAfternoon` (boolean), `takeEvening` (boolean).
-   **Stock**: `id`, `name`, `medicines` (Medicine[]), `medicineCount` (optional number), `createdAt`.

## 3. Page-Specific Implementations

### Page 1: Dashboard (`/dashboard`)
**Goal:** Display a list of user's medicine stocks (e.g., "Bedroom Cabinet", "Travel Bag").

**Features:**
1.  **Header:** "Dosely" logo (left), "Logout" button (right).
2.  **Search Bar:** Large, pill-shaped input. Debounce search queries (500ms) to filter stocks.
3.  **Add Stock Button:** Opens `CreateStockModal`.
    -   **Optimistic UI:** When created, prepend the new stock to the list locally *before* or *immediately after* API success to avoid full reload.
4.  **Stock List (Infinite Scroll):**
    -   Fetch stocks in pages of 10.
    -   Use `IntersectionObserver` on the last `StockCardItem` to trigger fetching the next page.
    -   **Logic:** Append new results to existing state. filtering duplicates if necessary.
5.  **Stock Card Design:**
    -   Display Name.
    -   Display Count: If backend provides `medicineCount`, use it. Else fallback to `medicines.length`.
    -   **Actions:** "View" (navigates to details) and "Delete" (opens `DeleteStockModal`).
6.  **Delete Logic:** Optimistically remove the item from the UI list upon confirmation.

### Page 2: Stock Detail (`/stock/:id`)
**Goal:** Manage medicines within a specific stock.

**Layout:**
-   **Header:**
    -   Stock Name (Huge 4xl font).
    -   **Edit Pencil Icon:** Next to name. Clicks opens `EditStockModal` to rename stock.
    -   "Back to Dashboard" link.
    -   "Add Medication" button (opens Modal).
-   **3-Column Grid:** "Morning", "Noon", "Evening".
    -   Filter `stock.medicines` based on `takeMorning`, `takeAfternoon`, `takeEvening`.
    -   A medicine can appear in multiple columns if multiple flags are true.

**Medicine Card Design (Critical):**
-   **Visuals:** White card, rounded-3xl, shadow-sm.
-   **Top Row:** Medicine Name (Bold, Left) | Dose (e.g. "500 mg", Gray, Right next to name) | Edit/Delete Action Buttons (Top Right, visible on hover group).
-   **Bottom Row:** Quantity (Big Font, Left aligned under name).
-   **Color Coding Logic for Quantity:**
    -   `<= 5`: **Red** (Text-Red-600)
    -   `>= 10`: **Green** (Text-Emerald-600)
    -   Otherwise: **Orange** (Text-Orange-500)

**Add/Edit Medicine Logic:**
-   **Inputs:** Name (Text), Dose (Number, step="any", min="0"), Quantity (Number, min="0").
-   **Toggles:** 3 Buttons for Morning/Noon/Evening (Visual toggle style: Gray -> Colored when active).
-   **Optimization:**
    -   **Add:** Backend API returns *only* the new Medicine object. Frontend appends it to state: `setStock(prev => ({ ...prev, medicines: [...prev.medicines, newMed] }))`. **Do NOT fetch the whole stock again.**
    -   **Edit:** Update the specific item in the array locally.
    -   **Delete:** Filter out the item locally.

## 4. UI/Design System Guidelines

**Aesthetics:** "Premium, Soft, Modern"
-   **Radius:** Use `rounded-2xl` or `rounded-3xl` extensively.
-   **Shadows:** Soft, diffused shadows (`shadow-lg shadow-blue-200`).
-   **Colors:**
    -   Primary: Blue-600 (Action buttons).
    -   Backgrounds: Slate-50 (Page bg), White (Cards).
    -   Time Slots:
        -   Morning: Orange theme (Orange-50 bg, Orange-500 text).
        -   Noon: Blue theme.
        -   Evening: Indigo theme.
-   **Feedback:**
    -   Show `Loader2` spinners inside buttons when actions are processing.
    -   Disable buttons while loading.

## 5. API Services (`services/`)

Create strict service layers.
-   **stockService.ts**:
    -   `getAll(page, limit)`
    -   `getOne(id)`
    -   `create(name)`
    -   `update(id, name)` -> For renaming.
    -   `delete(id)`
    -   `addMedicine(stockId, payload)` -> Returns `Promise<Medicine>`
    -   `editMedicine(medId, payload)`
    -   `deleteMedicine(medId)`
```

## 6. ğŸš€ Deployment & Docker

### ğŸ³ Docker Build Targets
This project uses multi-stage builds. When deploying, you can target specific environments:

**Development:**
```bash
docker build --target development -t medicine-tracker-dev .
```

**Production (Default):**
```bash
docker build --target production -t medicine-tracker-prod .
```
> **Note on Nginx:** The production build uses **Nginx** (Alpine) to serve the static files on port 80. It includes a custom `nginx.conf` to handle React routing (SPA fallback to `index.html`).

### ğŸ” Security Notes
- **Environment Variables**:
  - We removed sensitive keys like `GEMINI_API_KEY` from `vite.config.ts`.
  - Local `.env` files are **ignored** in `.dockerignore` to prevent secret leaks in production images.
- **Runtime Injection**:
  - Use `env_file` in `docker-compose.yml` for local development.
  - Configure environment variables in your deployment dashboard (e.g., Render) for production.

